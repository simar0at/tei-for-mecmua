<?xml version="1.0" encoding="utf-8"?>
<!--Copyright TEI Consortium. 
Licensed under the GNU General Public License. 
See the file COPYING for details
$Date$
$Author$
-->
<elementSpec xmlns="http://www.tei-c.org/ns/1.0" module="header" usage="opt" ident="cRefPattern">
  <equiv/>
  <gloss>defines how to convert a canonical reference into a URI</gloss>
  <gloss xml:lang="zh-tw">權威參照模式，定義如何將一個權威參照轉換成URI</gloss>
  <gloss xml:lang="fr">Adressage de fragments</gloss>
  <gloss xml:lang="fr">définit comment convertir une référence canonique en URI</gloss>
  <desc>specifies an expression and replacement pattern for
  tranforming a canonical reference into a URI</desc>
  <desc xml:lang="zh-tw">標明將權威參照轉換成URI的表示方法與取代模式。</desc>
  <desc xml:lang="fr">L’élément Adressage de fragments <gi>fragmentPattern</gi> spécifie un modèle d’expression et des règles de remplacement pour transformer une référence canonique en URI.</desc>
  <content>
    <rng:zeroOrMore xmlns:rng="http://relaxng.org/ns/structure/1.0">
      <rng:ref name="model.pLike"/>
    </rng:zeroOrMore>
  </content>
  <attList>
    <attDef ident="matchPattern" usage="req">
      <equiv/>
      <desc>specifies a regular expression against which the values of
      <att>cRef</att> attributes can be matched.</desc>
      <desc xml:lang="fr">spécifie une expression régulière à laquelle vont être comparées les valeurs des attributs <att>cRef</att>.
      </desc>
      <datatype>
        <rng:ref xmlns:rng="http://relaxng.org/ns/structure/1.0" name="data.pattern"/>
      </datatype>
      <valDesc>must be a regular expression according to the <ref target="http://www.w3.org/TR/xmlschema-2/#regexs">W3C XML Schema
      Language</ref></valDesc>
      <remarks>
        <p>Parenthesised groups are used not only for establishing
        order of precedence and atoms for quantification, but also for
        creating subpatterns to be referenced by the <att>pat</att>
        attribute.</p>
      </remarks>
      <remarks xml:lang="fr">
        <p>Les groupes parenthésés ne sont pas seulement utilisés pour établir un ordre de préséance et des unités de quantification, mais aussi pour créer des sous-modèles référencés par l'attribut <att>pat</att>.</p>
      </remarks>
    </attDef>
    <attDef ident="replacementPattern" usage="req">
      <equiv/>
      <desc>specifies a <soCalled>replacement pattern</soCalled>
      which, once subpattern substitution has been performed, provides
      a URI.</desc>
      <desc xml:lang="fr">spécifie une <soCalled>règle de remplacement</soCalled> qui, après avoir opéré les substitutions prévues à chaque nœud, génère une URI.</desc>
      <datatype>
        <rng:text xmlns:rng="http://relaxng.org/ns/structure/1.0"/>
      </datatype>
      <valDesc>Should be the skeleton of a relative or absolute URI,
      with references to groups in the <att>matchPattern</att>.</valDesc>
      <remarks>
        <p>The strings <q>$1</q> through <q>$9</q> are references to
	the corresponding group in the regular expression specified
	by <att>re</att> (counting open parenthesis, left to right).
	Processors are expected to replace them with whatever matched
	the corresponding group in the regular expression.</p>
        <p>If a digit preceded by a dollar sign is needed in the
	actual replacement pattern (as opposed to being used as a back
	reference), the dollar sign must be written as
	<code>%24</code>.</p>
      </remarks>
      <remarks xml:lang="fr">
        <p>Les chaînes <q>$1</q> à <q>$9</q> sont des références au groupe correspondant dans l'expression régulière spécifiée par l'attribut <att>re</att> (en incluant la parenthèse ouvrante, de gauche à droite). Les processeurs devraient remplacer ces groupes par les  valeurs correspondant aux groupes dans l'expression régulière.</p>
        <p>Si un chiffre précédé par un dollar est nécessaire dans le modèle de remplacement actuel (en opposition à ce qui a été utilisé comme référence antérieure), le signe dollar doit être encodé <code>%24</code>.</p>
      </remarks>
    </attDef>
  </attList>
  <exemplum>
    <egXML xmlns="http://www.tei-c.org/ns/Examples">
      <cRefPattern matchPattern="([1-9A-Za-z]+)\s+([0-9]+):([0-9]+)" replacementPattern="#xpath(//div[@type='book'][@n='$1']/div[@type='chap'][@n='$2']/div[@type='verse'][@n='$3'])"/>
    </egXML>
  </exemplum>
  <remarks>
    <p>The result of the substitution may be either an absolute or a
    relative URI reference. In the latter case it is combined with the
    value of <att>xml:base</att> in force at the place where the
    <att>cRef</att> attribute occurs to form an absolute URI in the
    usual manner as prescribed by <ref target="http://www.w3.org/TR/xmlbase/">XML Base</ref>.</p>
  </remarks>
  <remarks xml:lang="fr">
    <p>Le résultat de la substitution peut être soit la référence à une URI relative ou absolue. Dans ce dernier cas, il est combiné avec la valeur de l'attribut <att>xml:base</att> en vigueur à la place où apparaît l'attribut <att>cRef</att> pour former une URI absolue selon l'usage habituel indiqué par <ref target="http://www.w3.org/TR/xmlbase/">XML Base</ref>.</p>
  </remarks>
  <listRef>
    <ptr target="#HD54M"/>
    <ptr target="#HD54"/>
    <ptr target="#HD54S"/>
  </listRef>
</elementSpec>
